<!DOCTYPE html>
<html lang="en">
<head>
 <title>Client Integration Test</title>
 
 <meta charset="utf-8" />
 <meta name="author" content="erenon" />

 <link href="../client/css/style.css" type="text/css" rel="stylesheet" />
  
 <!--requires to launch testServer.js --> 
 <!--<script type="text/javascript" src="http://localhost:3000/socket.io/socket.io.js"></script>--> 
 <!--<script type="text/javascript" src="../client/js/SocketioGateway.js"></script>-->
 
 <script type="text/javascript" src="../client/js/jquery.js"></script>
 <script type="text/javascript" src="../client/js/jquery.csshooks.js"></script> 
 <script type="text/javascript" src="../client/js/PubSub.js"></script>
 <script type="text/javascript" src="../client/js/EventQueue.js"></script>
 <script type="text/javascript" src="../client/js/CardBuilder.js"></script>
 <script type="text/javascript" src="../client/js/Deck.js"></script>
 <script type="text/javascript" src="../client/js/PenaltyIndicator.js"></script>
 <script type="text/javascript" src="../client/js/StatusBar.js"></script>
 <script type="text/javascript" src="../client/js/Player.js"></script>
 <!--<script type="text/javascript" src="../client/js/main.js"></script>-->

<script>
$(document).ready(function() {
    var /*socket = SocketioGateway({
            io: io
        }),*/
        pubsub = PubSub({
            //socket: socket
        }),
        eventQueue = EventQueue(),
        cardBuilder = CardBuilder({
            $: $,
            pubsub: pubsub
        }),
        stock = Stock({
            $: $,
            target: $('#stock'),
            pubsub: pubsub,
            events: eventQueue
        }),
        pile = Pile({
            $: $,
            target: $('#pile'),
            events: eventQueue,
            pubsub: pubsub,
            stock: stock,
            cardBuilder: cardBuilder
        }),
        //statusBar
        player = ControlledPlayer({
            $: $,
            pubsub: pubsub,
            target: $('.horizontalPlayer')[1],
            cardBuilder: cardBuilder,
            stock: stock,
            pile: pile,
            name: 'player',
            events: eventQueue
        }),
        oppositeTop = OppositePlayer({
            $: $,
            pubsub: pubsub,
            target: $('.horizontalPlayer')[0],
            cardBuilder: cardBuilder,
            stock: stock,
            pile: pile,
            name: 'oppositeTop',
            orientation: 180,
            events: eventQueue           
        }),
        oppositeLeft = OppositePlayer({
            $: $,
            pubsub: pubsub,
            target: $('.verticalPlayer')[0],
            cardBuilder: cardBuilder,
            stock: stock,
            pile: pile,
            name: 'oppositeLeft',
            orientation: 270,
            events: eventQueue           
        }),
        oppositeRight = OppositePlayer({
            $: $,
            pubsub: pubsub,
            target: $('.verticalPlayer')[1],
            cardBuilder: cardBuilder,
            stock: stock,
            pile: pile,
            name: 'oppositeRight',
            orientation: 90,
            events: eventQueue           
        })
        ;
        
    pubsub.emitSync('changeViewportSize', {
        height: $(window).height(),
        width: $(window).width()
    });
    
    $(window).resize(function() {
        pubsub.emitSync('changeViewportSize', {
            height: $(window).height(),
            width: $(window).width()
        });        
    });   
        
    PenaltyIndicator({
        pubsub: pubsub,
        target: $('#penaltyIndicator')
    });  
    
    pubsub.emitSync('draw_card', {
        player: {
            name: 'oppositeTop'
        },
        card_count: 2
    });  
    
    pubsub.emitSync('draw_card', {
        player: {
            name: 'oppositeLeft'
        },
        card_count: 6
    });
    
    pubsub.emitSync('draw_card', {
        player: {
            name: 'oppositeRight'
        },
        card_count: 3
    });
    
    pubsub.emitSync('get_card', {
       player: {
           name: 'player'
       },
       card: {
           color: 'blue',
           value: 'block'
       }
    });
        
    pubsub.emitSync('get_card', {
       player: {
           name: 'player'
       },
       card: {
           color: 'red',
           value: 3
       }
    });
    
    pubsub.emitSync('game_start', {
        first_card: {
            color: 'red',
            value: 7
        }
    });  
});    
</script>
</head>
<body>
<div id="gameTableContainer">
<table id="gameTable">
    <tr>
        <td><!-- empty cell --></td>
        <td class="playerContainer horizontalPlayerContainer topPlayerContainer">
            <!-- top player -->
            <div class="horizontalPlayer">
            </div>
        </td>
        <td><!-- empty cell --></td>
    </tr>
    <tr>
        <td class="playerContainer verticalPlayerContainer leftPlayerContainer">
            <!-- left player -->
            <div class="verticalPlayer">
            </div>
        </td>
        <td><!-- middle -->
            <div class="deckContainer">
                <div class="deck" id="pile">
                </div>
                <div class="deck" id="stock">
                    <div class="card card-backside" data-card='{"color": "backside", "value": "backside"}'><div class="card-inner">UNO</div></div>
                    <div class="card card-backside" data-card='{"color": "backside", "value": "backside"}'><div class="card-inner">UNO</div></div>
                    <div class="card card-backside" data-card='{"color": "backside", "value": "backside"}'><div class="card-inner">UNO</div></div> 
                </div>
            </div>
        </td>
        <td class="playerContainer verticalPlayerContainer rightPlayerContainer">
            <!-- right cell -->
            <div class="verticalPlayer">
            </div>
        </td>
    </tr>
    <tr>
        <td><!-- empty cell --></td>
        <td class="playerContainer horizontalPlayerContainer bottomPlayerContainer">
            <!-- controlled player -->
            <div class="horizontalPlayer">
            </div>
            <div id="penaltyIndicator"></div>
        </td>
        <td><!-- empty cell --></td>
    </tr>
</table>
</div>
</body>
</html>

